<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parallelogramm ‚Äì Zerlegung wie GeoGebra</title>
<link rel="stylesheet" href="shared.css">
<script src="quiz-data.js"></script>
<script src="common-utils.js"></script>
</head>
<body>

<nav>
    <a href="index.html">‚Üê Zur√ºck zur √úbersicht</a>
    <a href="drachen.html">Drachen</a>
    <a href="parallelogramm.html" class="active">Parallelogramm</a>
    <a href="rhombus.html">Rhombus</a>
</nav>

<h2>Fl√§che eines Parallelogramms ‚Äì Zerlegung (GeoGebra-Stil)</h2>

<div id="label">Zieh mich!</div>
<input id="slider" type="range" min="0" max="1" step="0.001" value="0">

<div class="canvas-container">
    <canvas id="canvas"></canvas>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const slider = document.getElementById("slider");

// Grundgr√∂√üen √§hnlich wie im GeoGebra-Material - will be scaled
const baseA = 240;
const baseH = 140;
const baseSkew = 90;

function getScaleFactor() {
    return canvas.width / 900;
}

// Make canvas responsive
function resizeCanvas() {
    const container = canvas.parentElement;
    const containerWidth = container.clientWidth;
    const maxWidth = 900;
    const maxHeight = 450;
    
    canvas.width = Math.min(containerWidth, maxWidth);
    canvas.height = canvas.width * (maxHeight / maxWidth);
    
    draw();
}

window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    const t = Number(slider.value);
    
    const scale = getScaleFactor();
    const a = baseA * scale;
    const h = baseH * scale;
    const skew = baseSkew * scale;

    // Punkte des Parallelogramms
    const A = {x:250 * scale, y:150 * scale};
    const B = {x:250 * scale + a, y:150 * scale};
    const C = {x:250 * scale + a - skew, y:150 * scale + h};
    const D = {x:250 * scale - skew, y:150 * scale + h};

    // Dreieck zum Ausschneiden
    const T1 = {x:A.x, y:A.y};
    const T2 = {x:D.x, y:D.y};
    const T3 = {x:A.x, y:D.y};

    // Schrittgrenzen (wie GeoGebra)
    const heightStart = 0.15;
    const colorStart = 0.30;
    const moveStart = 0.55;
    const endStart = 0.80;

    // Beschriftung a und b
    const fontSize = Math.max(12, 20 * scale);
    ctx.font = fontSize + "px Arial";
    ctx.fillStyle = "black";
    ctx.fillText("a", (A.x+B.x)/2, A.y - 10 * scale);

    // 1) Parallelogramm
    if (t < moveStart) {
        ctx.fillText("b", A.x - 70, (A.y+D.y)/2);
        ctx.fillStyle = "#ADD8FF";
        drawPolygon(ctx, [A,B,C,D]);
    } else {
        ctx.fillStyle = "#ADD8FF";
	const A_new = {x: A.x, y: A.y + h};
	drawPolygon(ctx, [A, B, C, A_new]);
    }
   

    // 2) H√∂he einzeichnen
    

    // 3) Linkes Dreieck farbig markieren (aber nur bis es bewegt wird)
    if (t >= colorStart && t < moveStart) {
        ctx.fillStyle = "#5B8BFF";
        drawPolygon(ctx, [T1,T2,T3]);
    }
    if (t >= heightStart) {
        drawLine(ctx, A.x, A.y, A.x, A.y + h, "black");
        drawText(ctx, A.x - 20 * scale, A.y + h/2, "h", scale, "black");
    }
    // 4) Dreieck verschieben
    if (t >= moveStart) {
        const moveT = Math.min((t - moveStart) / (endStart - moveStart), 1);

        // Bewegungspfad: von A ‚Üí B
        const dx = (B.x - A.x) * moveT;
        const dy = (B.y - A.y) * moveT;

        ctx.fillStyle = "#5B8BFF";
        drawPolygon(ctx, [
            {x:T1.x + dx, y:T1.y + dy},
            {x:T2.x + dx, y:T2.y + dy},
            {x:T3.x + dx, y:T3.y + dy}
        ]);
    }

    // 5) Endzustand: Rechteck
    if (t >= endStart) {
        drawText(ctx, B.x + 40, A.y + 10, "‚Üí Rechteck", scale, "green", 26);
    }
}

slider.oninput = draw;
draw();
</script>

<!-- Quiz Section -->
<div class="quiz-section">
    <h2 style="color: #333; margin-bottom: 20px;">üßÆ Quiz: Berechne die Fl√§che!</h2>
    
    <div class="quiz-card">
        <div class="quiz-canvas-container">
            <canvas id="parallelogramm-quiz-canvas"></canvas>
        </div>
        
        <div class="quiz-dimensions">
            <strong>Gegeben:</strong><br>
            Grundseite a = <span id="parallelogramm-a">15</span> cm<br>
            H√∂he h = <span id="parallelogramm-h">6</span> cm
        </div>
        
        <div class="quiz-hint">
            üí° Tipp: Die Formel f√ºr die Fl√§che eines Parallelogramms lautet: A = a √ó h
        </div>
        
        <div class="quiz-answer-section">
            <div class="quiz-input-group">
                <label for="parallelogramm-answer">Deine Antwort:</label>
                <input type="number" id="parallelogramm-answer" placeholder="z.B. 90">
                <span style="font-size: 18px;">cm¬≤</span>
                <button onclick="checkParallelogrammQuiz()" class="quiz-btn">Pr√ºfen</button>
            </div>
            
            <div id="parallelogramm-result" class="quiz-result"></div>
            
            <button onclick="toggleParallelogrammSolution()" class="quiz-btn-secondary">L√∂sung anzeigen</button>
            <button onclick="newParallelogrammProblem()" class="quiz-btn-success">Neue Aufgabe</button>
            
            <div id="parallelogramm-solution" class="quiz-solution">
                <strong>L√∂sung:</strong><br>
                A = a √ó h<br>
                A = <span id="parallelogramm-sol-a">15</span> cm √ó <span id="parallelogramm-sol-h">6</span> cm<br>
                A = <strong><span id="parallelogramm-sol-answer">90</span> cm¬≤</strong>
            </div>
        </div>
    </div>
</div>

<script>
// Initialize quiz for parallelogramm
currentProblems.parallelogramm = 0;

function drawParallelogrammQuiz() {
    const canvas = document.getElementById('parallelogramm-quiz-canvas');
    const ctx = canvas.getContext('2d');
    
    // Make quiz canvas responsive
    const container = canvas.parentElement;
    const containerWidth = container.clientWidth;
    const maxWidth = 900;
    canvas.width = Math.min(containerWidth, maxWidth);
    canvas.height = canvas.width * 0.5;
    
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    const problem = getCurrentProblem('parallelogramm');
    const scale = canvas.width / 300;
    const a = problem.a * 10 * scale;
    const h = problem.h * 10 * scale;
    const skew = 30 * scale;
    const x = 75 * scale, y = 70 * scale;
    
    // Draw shape
    ctx.fillStyle = '#ADD8FF';
    ctx.strokeStyle = '#333';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(x, y);
    ctx.lineTo(x + a, y);
    ctx.lineTo(x + a - skew, y + h);
    ctx.lineTo(x - skew, y + h);
    ctx.closePath();
    ctx.fill();
    ctx.stroke();
    
    // Draw dashed height line
    ctx.strokeStyle = '#666';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([5, 5]);
    ctx.beginPath();
    ctx.moveTo(x, y);
    ctx.lineTo(x, y + h);
    ctx.stroke();
    // Draw dashed baseline extension
    ctx.beginPath();
    ctx.moveTo(x - skew, y + h);
    ctx.lineTo(x, y + h);
    ctx.stroke();
    ctx.setLineDash([]);
    
    // Labels
    const fontSize = Math.max(12, 16 * scale);
    ctx.font = fontSize + 'px Arial';
    ctx.fillStyle = '#333';
    ctx.fillText('a = ' + problem.a + ' cm', x + a/2 - 30 * scale, y - 10 * scale);
    ctx.fillText('h = ' + problem.h + ' cm', x - 50 * scale, y + h/2);
}

function updateParallelogrammQuizDisplay() {
    const problem = getCurrentProblem('parallelogramm');
    document.getElementById('parallelogramm-a').textContent = problem.a;
    document.getElementById('parallelogramm-h').textContent = problem.h;
    document.getElementById('parallelogramm-sol-a').textContent = problem.a;
    document.getElementById('parallelogramm-sol-h').textContent = problem.h;
    document.getElementById('parallelogramm-sol-answer').textContent = problem.answer;
    drawParallelogrammQuiz();
}

window.addEventListener('resize', function() {
    if (document.getElementById('parallelogramm-quiz-canvas')) {
        drawParallelogrammQuiz();
    }
});

function newParallelogrammProblem() {
    newQuizProblem('parallelogramm', updateParallelogrammQuizDisplay);
}

function checkParallelogrammQuiz() {
    const correct = getCurrentProblem('parallelogramm').answer;
    checkQuizAnswer('parallelogramm', correct);
}

function toggleParallelogrammSolution() {
    toggleQuizSolution('parallelogramm');
}

// Initialize quiz
setupQuizEnterKey('parallelogramm', checkParallelogrammQuiz);
drawParallelogrammQuiz();
</script>

</body>
</html>